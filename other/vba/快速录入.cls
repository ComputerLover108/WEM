VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "快速录入"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
'获得基本数据
Sub getBaseData(ByRef table As Object)
    On Error GoTo ErrorHandler

    Dim row As Long
    Dim column As Long
    Dim lastRow As Long
    Dim lastColumn As Long
    Dim offset As Integer
    lastRow = UsedRange.Rows.count
    lastColumn = UsedRange.Columns.count
    column = 2
    Dim temp As String
    dim data
    Dim h As New help
'    获得基本数据
    For row = 1 To lastRow
        temp = Cells(row, column).value
'        日期
        If temp Like "*日期*" Then
            offset = 1
            If IsEmpty(Cells(row, column + offset).value) Or IsNull(Cells(row, column + offset).value) Then
                MsgBox prompt:="没有填写日期！请重新填写！", Buttons:=vbOKOnly
                Exit Sub
            End If 
            data = datevalue(Cells(row, column + offset).value)
            if not isempty(data) then
                table.add "日期",data
            end if
        End If
'        天然气
'        稳定区
        If temp Like "*稳定区*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "稳定区",data
            end if            
        End If
'        入厂厂计量
        If temp Like "*入厂计量*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "入厂计量",data
            end if           
        End If
'        JZ20-2体系
        If temp Like "*JZ20-2体系*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "JZ20-2体系",data
            end if             
        End If
'        锦天化
        If temp Like "*锦天化*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "锦天化",data
            end if             
        End If
'        精细化工
        If temp Like "*精细化工*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "精细化工",data
            end if             
        End If
'        污水处理厂
        If temp Like "*污水处理厂*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "污水处理厂",data
            end if             
        End If
'        CNG
        If temp Like "*CNG*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "CNG",data
            end if             
        End If
'        新奥燃气
        If temp Like "*新奥燃气*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "新奥燃气",data
            end if             
        End If
'        自用气
        If temp Like "*自用气*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "自用气",data
            end if             
        End If
'    海管
'        海管来液含水
        If temp Like "*海管来液含水*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管来液含水上午",data
            end if             
            offset = 2
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管来液含水下午",data
            end if             
        End If
'        海管MEG浓度
        If temp Like "*海管MEG浓度*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管MEG浓度上午",data
            end if             
            offset = 2
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管MEG浓度下午",data
            end if             
        End If
'        海管出口凝点
        If temp Like "*海管出口凝点*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管出口凝点上午",data
            end if             
            offset = 2
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管出口凝点下午",data
            end if             
        End If
'        海管出口PH值
        If temp Like "*海管出口PH值*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管出口PH值上午",data
            end if             
            offset = 2
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管出口PH值下午",data
            end if             
        End If
'        海管进出口压力
        If temp Like "*海管进*出口压力*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管进出口压力",data
            end if             
        End If
'        海管进出口温度
        If temp Like "*海管进*出口温度*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管进出口温度",data
            end if             
        End If
'        海管通球备注
        If temp Like "*海管通球备注*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "海管通球备注",data
            end if             
        End If
'    上游
'        JZ25-1S原油
        If temp Like "*JZ25-1S原油*" Then
'            offset = 1
'            JZ251S原油 = Cells(row, column + offset).value
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "JZ251S原油密度",data
            end if             
        End If
'        JZ20-2凝析油
        If temp Like "*JZ20-2凝析油*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "JZ202凝析油",data
            end if             
            offset = 2
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "JZ202凝析油密度",data
            end if             
        End If
'        JZ20-2轻油
        If temp Like "*JZ20-2轻油*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "JZ202轻油",data
            end if             
            offset = 2
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "JZ202轻油密度",data
            end if             
        End If
'    轻油
'        V631A
        If temp Like "*V-631A*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "V631A",data
            end if             
        End If
'        V631B
        If temp Like "*V-631B*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "V631B",data
            end if             
        End If
'        V631C
        If temp Like "*V-631C*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "V631C",data
            end if             
        End If
'        轻油装车t
        If temp Like "*轻油装车t*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "轻油装车t",data
            end if             
        End If
'        轻油装车m3
        If temp Like "*轻油装车m3*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "轻油装车m3",data
            end if             
        End If
'        轻油装车bbl
        If temp Like "*轻油装车bbl*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "轻油装车bbl",data
            end if             
        End If
'        外输凝点
        If temp Like "*外输凝点*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "外输凝点",data
            end if             
        End If
'        外输PH值
        If temp Like "*外输PH值*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "外输PH值",data
            end if             
        End If
'        轻油入罐前含水
        If temp Like "*轻油入罐前*含水*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "轻油入罐前含水",data
            end if             
        End If
'        饱和蒸汽压
        If temp Like "*饱和蒸汽压*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "饱和蒸汽压",data
            end if             
        End If
'        轻油比重
        If temp Like "*轻油比重*" Then
            offset = 1
            If 0 = 轻油比重 Then
                MsgBox ("没有填写轻油比重或填写错误!")
                Exit Sub
            End If
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "轻油密度",data
            end if             
        End If
'    丙丁烷
'        V641A
        If temp Like "*V-641A*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "V641A",data
            end if             
        End If
'        V641B
        If temp Like "*V-641B*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "V641B",data
            end if             
        End If
'        V642
        If temp Like "*V-642*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "V642",data
            end if             
        End If
'        V643A
        If temp Like "*V-643A*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "V643A",data
            end if             
        End If
'        V643B
        If temp Like "*V-643B*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "V643B",data
            end if             
        End If
'        丙烷装车t
        If temp Like "*丙烷装车t*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "丙烷装车t",data
            end if             
        End If
'        丁烷装车t
        If temp Like "*丁烷装车t*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "丁烷装车t",data
            end if             
        End If
'        液化气装车t
        If temp Like "*液化气装车t*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "液化气装车t",data
            end if             
        End If
'    数据库
'        数据库轻油回收
        If temp Like "*数据库轻油回收*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "数据库轻油回收",data
            end if             
        End If
'        数据库丙丁烷回收
        If temp Like "*数据库丙丁烷回收*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "数据库丙丁烷回收",data
            end if             
        End If
'    化学药剂
'        乙二醇生产
        If temp Like "*乙二醇日回收量*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "乙二醇生产",data
            end if             
        End If
'        乙二醇浓度
        If temp Like "*乙二醇浓度*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "乙二醇浓度",data
            end if             
        End If
'        乙二醇消耗
        If temp Like "*乙二醇日耗量*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "乙二醇消耗",data
            end if             
        End If
'        甲醇消耗
        If temp Like "*甲醇日耗量*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "甲醇消耗",data
            end if             
        End If
'    水
'        外供水
        If temp Like "*外供水*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "外供水",data
            end if             
        End If
'        自采水
        If temp Like "*自采水*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "自采水",data
            end if             
        End If
'        污水
        If temp Like "*污水*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "污水",data
            end if             
        End If
'        水池水位
        If temp Like "*水池水位*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "水池水位",data
            end if             
        End If
'    电
'        外供电
        If temp Like "*外供电*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "外供电",data
            end if             
        End If
'        自发电
        If temp Like "*自发电*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "自发电",data
            end if             
        End If
'    生产备注
        If temp Like "*生产备注*" Then
            offset = 1
            data = Cells(row, column + offset).value
            if not isempty(data) then
                table.add "生产备注",data
            end if             
        End If
    Next row
ErrorHandler:
    Debug.Print Err.Number & vbTab & Err.Description
    Resume Next
End Sub
'获得配产数据
Sub getProrationData(ByRef table As Object)
    On Error GoTo ErrorHandler
    Dim temp
    Dim md, yd
    Dim row, column, beginRow, beginColumn, lastRow, lastColumn, offset
    Worksheets("快速录入").Select
    lastRow = Worksheets("快速录入").UsedRange.Rows.count
    lastColumn = Worksheets("快速录入").UsedRange.Columns.count
'    获得配产数据
    For row = 1 To lastRow
        For column = 1 To lastColumn
            temp = Cells(row, column).value
            If temp = "配产任务" Then
                beginRow = row
                beginColumn = column
            End If
        Next column
    Next row
    For row = beginRow To lastRow
        For column = beginColumn To lastColumn
            temp = Cells(row, column).value
'            Debug.Print temp
    '        配产
            If temp Like "*天然气104m3*" Then
                offset = 1
                md = Cells(row, column + offset).value
                If Not IsEmpty(md) Then
                    table.Add "天然气月配产", md
                End If
                offset = 2
                yd = Cells(row, column + offset).value
                If Not IsEmpty(md) Then
                    table.Add "天然气年配产", yd
                End If
            End If
            If temp Like "*轻油m3*" Then
                offset = 1
                md = Cells(row, column + offset).value
                If Not IsEmpty(md) Then
                    table.Add "轻油月配产", md
                End If
                offset = 2
                yd = Cells(row, column + offset).value
                If Not IsEmpty(md) Then
                    table.Add "轻油年配产", yd
                End If
            End If
            If temp Like "*丙丁烷m3*" Then
                offset = 1
                md = Cells(row, column + offset).value
                If Not IsEmpty(md) Then
                    table.Add "丙丁烷月配产", md
                End If
                offset = 2
                yd = Cells(row, column + offset).value
                If Not IsEmpty(md) Then
                    table.Add "丙丁烷年配产", yd
                End If
            End If
        Next column
    Next row
ErrorHandler:
    If 0 = Err.Number Or 20 = Err.Number Then
    Else
        Debug.Print Err.Number & vbTab & Err.Description
    End If
    Resume Next
End Sub

Public Sub test()
    Dim table As Object
    Set table = CreateObject("Scripting.Dictionary")
End Sub
